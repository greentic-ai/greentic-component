---
id: PR-01
title: Wizard scaffold + 0.6.0 template generator (cargo-new style)
date: 2026-02-05
repo: greentic-component
track: component-wizard
depends_on: []
---

# PR-01: Wizard scaffold + 0.6.0 template generator

## Goal
Add a new top-level CLI group `greentic-component wizard` and implement `wizard new` to generate a **full Cargo component template** targeting **component@0.6.0** (CBOR + self-describing + i18n + greentic-qa modes default/setup/upgrade/remove).

This PR is **scaffolding + template generation only**. No flow integration and minimal doctor changes.

## CLI
### New command group
- `greentic-component wizard ...`

### Implemented in PR-01
- `greentic-component wizard new <name> [--abi-version 0.6.0] [--mode default|setup] [--answers <answers>.json] [--out <dir>]`

Notes:
- `--abi-version` default is `0.6.0`. The generator must accept arbitrary semver strings, but only emit a 0.6.0 template for now.
- `--mode` controls which QA mode is used to pre-fill defaults if `--answers` is provided. Default mode is `default`.

## Template output layout
Generate directory `<out>/<name>/` with:

- `Cargo.toml` (library crate)
- `src/lib.rs` with stubs:
  - describe
  - qa-spec
  - apply-answers
  - run
- `wit/package.wit` that defines the component@0.6.0 world usage for this component (importing the canonical interfaces-types, etc as required by repo conventions)
- `src/qa.rs` stubs for QA modes:
  - default/setup/upgrade/remove
- `src/schemas.rs` with CBOR schema byte placeholders (deterministic constants or builder functions)
- `src/i18n.rs` with example key registry + helper
- `examples/`:
  - `default.answers.json`
  - `setup.answers.json`
  - `upgrade.answers.json`
  - `remove.answers.json`
  - `example.schema.json` (placeholder)
- `README.md` (what to edit next)
- `Makefile` will be added in PR-02 (stub file ok in PR-01 if desired)

## Behavior
- If `--answers` is passed, read JSON, convert to CBOR (canonical), and use the answers inside greentic-qa to set up the component with those values. Do not overwrite `examples/<mode>.answers.json` or `examples/default.answers.json` yet in PR-01.
- Do not attempt to build WASM yet (PR-02).

## Implementation notes
- Implement generation in Rust (no shelling out to `cargo new`).
- Ensure generated files are deterministic (stable ordering, no timestamps in generated code; date may appear in README only).
- Add basic unit tests for:
  - directory + file creation
  - `Cargo.toml` includes package name
  - expected files exist

## Clarifications
- `--answers` is for wiring into greentic-qa setup using provided values, not for overwriting example answer files in this PR.
- `src/schemas.rs` should use placeholders only in PR-01; no requirement to generate CBOR schema bytes from `example.schema.json` yet. Deterministic stubs that teach structure are sufficient.

## Acceptance criteria
- `greentic-component wizard new hello-world` produces the full template tree.
- `cargo test` in greentic-component passes.
- No existing commands break.
